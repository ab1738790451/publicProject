<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="/static/layui/layui.js"  type="text/javascript"></script>
    <script src="/static/js/publicUtils.js" type="text/javascript"></script>
    <script src="/static/js/common.js" type="text/javascript"></script>
    <link href="/static/layui/css/layui.css" rel="stylesheet">
    <title th:text="${serviceName}"></title>
    <style>
       .main-body{
           padding: 18px;
       }
    </style>
</head>
<body class="main-body">
<form class="layui-form" action="/doModifyPassword" id="dataForm" METHOD="post">
    <div class="layui-form-item query-form-item">
        <div class="layui-inline">
            <label class="layui-form-label">旧密码</label>
            <div class="layui-input-inline">
                <input type="text" th:name="oldPassword"   lay-verify="required" autocomplete="off" class="layui-input" oninput="this.value=this.value.replace(/[^\w]/g,'')" onproperty="this.value=this.value.replace(/[^\w]/g,'')" maxlength="16">
            </div>
        </div>
    </div>
    <div class="layui-form-item query-form-item">
        <div class="layui-inline">
            <label class="layui-form-label">新密码</label>
            <div class="layui-input-inline">
                <input type="text"  lay-verify="required"  id="password" th:name="password"   autocomplete="off" class="layui-input" oninput="this.value=this.value.replace(/[^\w]/g,'')" onproperty="this.value=this.value.replace(/[^\w]/g,'')" maxlength="16">

            </div>
            <div class="layui-input-inline" >
                <button type="button" id="resetPassword" class="layui-btn layuiadmin-btn-list"  lay-filter="resetPassword">换一个</button>
            </div>

        </div>
    </div>
    <div class="layui-form-item query-form-item">
        <div class="layui-inline">
            <button id="save" class="layui-btn layuiadmin-btn-list" lay-submit  lay-filter="save">保存</button>
        </div>
    </div>

</form>
</body>
<script type="text/javascript">
    layui.use(['form','laydate'],function () {
          var laydate = layui.laydate;
          var form = layui.form;
       renderEdit('save','[[${lastLayId}]]');
    });

    let numCharPool = ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z','A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z'];
    $(function () {
            getPassword();
        $("#resetPassword").click(function () {
            getPassword();
        })

        $("#password").on('change',function () {
            document.execCommand('selectAll');
            document.execCommand('copy');
            layer.msg("密码已复制");
        })
    })

    function getPassword() {
        let len = Math.round(Math.random()*8)+8;
        let newPassWord = "";
        for (let i =0;i<len;i++){
            newPassWord +=  numCharPool[Math.floor(Math.random()*62)];
        }
        $("#password").val(newPassWord).change();
    }
</script>
</html>